# Environment Configuration
# Copy this file to .env and customize for your environment

# ============================================
# Service Ports
# ============================================
# Format: {SERVICE}_PORT (container internal port)
#         {SERVICE}_HOST_PORT (host machine port)


ELIXIR_IMAGE=hexpm/elixir:1.19.2-erlang-28.1-alpine-3.22.2

USER_SVC_PORT=8081
USER_SVC_HOST_PORT=8081

JOB_SVC_PORT=8082
JOB_SVC_HOST_PORT=8082

EMAIL_SVC_PORT=8083
EMAIL_SVC_HOST_PORT=8083

IMAGE_SVC_PORT=8084
IMAGE_SVC_HOST_PORT=8084

CLIENT_SVC_PORT=8085
CLIENT_SVC_HOST_PORT=8085

# Service URLs - These will be overridden in docker-compose for internal networking
# Docker uses service names (http://user_svc:8081), dev uses localhost
USER_SVC_URL=http://127.0.0.1:8081
JOB_SVC_URL=http://127.0.0.1:8082
EMAIL_SVC_URL=http://127.0.0.1:8083
IMAGE_SVC_URL=http://127.0.0.1:8084
CLIENT_SVC_URL=http://127.0.0.1:8085

GRAFANA_UI_PORT=3000
PROMETHEUS_UI_PORT=9090
JAEGER_UI_PORT=16686

MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin

GF_AUTH_ANONYMOUS_ENABLED=true
GF_AUTH_ANONYMOUS_ORG_ROLE=Admin
GF_AUTH_DISABLE_LOGIN_FORM=true

SPEC_URL="specs/user_svc.yaml"
PAGE_TITLE="Microservices API Documentation"

# ============================================
# OpenTelemetry Configuration
# ============================================
# Protocol options: "http" or "grpc"
# - http: OTLP/HTTP on port 4318 (default, easier debugging)
# - grpc: OTLP/gRPC on port 4317 (production, 2-5x faster)

OTEL_PROTOCOL=http
OTEL_ENDPOINT=http://jaeger:4318

# For gRPC (production optimization):
# OTEL_PROTOCOL=grpc
# OTEL_ENDPOINT=http://jaeger:4317

# ============================================
# MinIO (S3-Compatible Storage)
# ============================================
MINIO_PORT=9000
MINIO_SCHEME= "http://"
MINIO_CONSOLE_PORT=9001
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin
AWS_REGION=us-east-1
IMAGE_BUCKET=msvc-images
LOKI_CHUNKS=loki-chunks
IMAGE_BUCKET_MAX_AGE=3600

# ============================================
# Observability Stack
# ============================================
GRAFANA_PORT=3000
PROMETHEUS_PORT=9090
JAEGER_UI_PORT=16686
JAEGER_OTLP_HTTP_PORT=4318
JAEGER_OTLP_GRPC_PORT=4317
LOKI_PORT=3100
PROMTAIL_PORT=9080

# ============================================
# API Documentation
# ============================================
REDOC_PORT=8086
SWAGGER_UI_PORT=8087

# ============================================
# Application Environment
# ============================================
MIX_ENV=prod
LOG_LEVEL=info
# LOG_FORMAT=json  # Uncomment for JSON structured logging

# ============================================
# Database (Oban - SQLite)
# ============================================
DB_POOL_SIZE=5

# ============================================
# Example: Running Multiple Instances
# ============================================
# To run a second instance on different ports:
# 1. Copy this file to .env.staging
# 2. Change ports (e.g., USER_SVC_PORT=9000)
# 3. Run: docker compose --env-file .env.staging up
